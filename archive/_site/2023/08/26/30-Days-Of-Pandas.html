<!DOCTYPE html>
<html lang="en">
<meta charset="utf-8" /> 
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="canonical" href="http://localhost:4000/2023/08/26/30-Days-Of-Pandas.html">
<meta property="og:url" content="http://localhost:4000/2023/08/26/30-Days-Of-Pandas.html">
<meta name="twitter:card" content="summary_large_image">
<meta property="og:site_name" content="Calvin Khor">
<title>30 Days of Pandas | Calvin Khor</title>
<meta property="og:title" content="30 Days of Pandas | Calvin Khor">
<meta name="description" content="Quick notes on pandas (import pandas as pd) lets say df is a pd.DataFrame. to select we can use df[‚Ä¶], df.loc[‚Ä¶] or df.iloc[‚Ä¶] df[‚Ä¶] can be used to select one">
<meta property="og:description" content="Quick notes on pandas (import pandas as pd) lets say df is a pd.DataFrame. to select we can use df[‚Ä¶], df.loc[‚Ä¶] or df.iloc[‚Ä¶] df[‚Ä¶] can be used to select one">
<meta name="author" content="Calvin Khor">
<meta property="og:image" content="http://localhost:4000/assets/img/crystalballs.png">
<meta name="twitter:site" content="@kamivine">
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css" integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous"/>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.3.2/build/styles/default.min.css">
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.3.2/build/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<link rel="icon" type="image/jpeg" href="http://localhost:4000/favicon.png"/>
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.css?v=3">
<script src="http://localhost:4000/assets/js/main.js"></script>
<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>
<!--pudhina-fresh-jekyll-sun-chocolate-ruby-v-2021-02-22-->
<div class="wrapper">
<header class="header">
<div class="navigation">
<a href="http://localhost:4000" class="logo">CK</a>
<ul class="menu">
<li class="menu__entry"><a href="http://localhost:4000">home</a>
<li class="menu__entry"><a href="http://localhost:4000/projects">projects</a>
<li class="menu__entry"><a href="http://localhost:4000/posts">posts</a>
<li class="menu__entry"><a href="http://localhost:4000/2023/06/09/maths.html">maths</a>
</ul>
</div>
<ul class="social-links">
<a href="mailto:calvin_khor@hotmail.com" class="social-links__entry" target="_blank">
<i class="fas fa-envelope-square"></i>
</a>
<a href="https://github.com/clvnkhr" class="social-links__entry" target="_blank">
<i class="fab fa-github"></i>
</a>
<a href="https://in.linkedin.com/in/clvnkhr" class="social-links__entry" target="_blank">
<i class="fab fa-linkedin-in"></i>
</a>
    <a class="social-links__entry" href='#' onclick="switch_dark_mode_icon(darkmode, 'dark_mode_toggle')">
        <i style="color: rgba( 254, 164, 1, 100%);" id="dark_mode_toggle" class="fas fa-sun"></i>
    </a>
</ul>
  <script type="text/x-mathjax-config">
    MathJax = {
      tex: {
        packages: ['base'],        // extensions to use
        inlineMath: [              // start/end delimiter pairs for in-line math
          ['\\(', '\\)']
        ],
        displayMath: [             // start/end delimiter pairs for display math
          ['$$', '$$'],
          ['\\[', '\\]']
        ],
        processEscapes: true,      // use \$ to produce a literal dollar sign
        processEnvironments: true, // process \begin{xxx}...\end{xxx} outside math mode
        processRefs: true,         // process \ref{...} outside of math mode
        digits: /^(?:[0-9]+(?:\{,\}[0-9]{3})*(?:\.[0-9]*)?|\.[0-9]+)/,
                                   // pattern for recognizing numbers
        tags: 'none',              // or 'ams' or 'all'
        tagSide: 'right',          // side for \tag macros
        tagIndent: '0.8em',        // amount to indent tags
        useLabelIds: true,         // use label name rather than tag for ids
        maxMacros: 1000,           // maximum number of macro substitutions per expression
        maxBuffer: 5 * 1024,       // maximum size for the internal TeX string (5K)
        baseURL:                   // URL for use with links to tags (when there is a<base> tag in effect)
           (document.getElementsByTagName('base').length === 0) ?
            '' : String(document.location).replace(/#.*$/, '')),
        formatError:               // function called when TeX syntax errors occur
            (jax, err) => jax.formatError(err)
      }
    };
  </script>
  <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>
</header>
<br>
<br>
    <a href="http://localhost:4000/tags/coding" style="background-color: rgba( 144, 207, 106, 100%);" class="badge badge-primary">#coding</a>
    <a href="http://localhost:4000/tags/maths" style="background-color: rgba( 144, 106, 207, 100%);" class="badge badge-primary">#maths</a>
<h1 class="post-title">
   <div class="post-title__text">30 Days of Pandas</div>
</h1>
<p class="post-title__subtitle">Published Aug 26, 2023  by <a href="https://clvnkhr.github.io" target="_blank">Calvin Khor</a></p>
<img class="splash-img" src="http://localhost:4000/assets/img/crystalballs.png" loading="lazy" alt="">
<br>
<div class="post_wrapper">
   <p>Quick notes on pandas (<code class="highlighter-rouge">import pandas as pd</code>)</p>
<p>lets say df is a pd.DataFrame. to select we can use df[‚Ä¶], df.loc[‚Ä¶] or df.iloc[‚Ä¶]</p>
<p>df[‚Ä¶] can be used to select one or more columns by their names, or to select rows by a boolean mask.
df.loc[‚Ä¶] can be used to select rows and columns by their labels, or by a boolean mask. The labels can be the index or column names, or a range of them.</p>
<p>df[‚Ä¶] cannot be used to select rows and columns simultaneously, unless the rows are selected by a boolean mask, so</p>
<p>Note df[‚Äúcolname‚Äù] and df.loc[‚Äúcolname‚Äù] will return a series: to return a df, use a list of column names i.e. df[[‚Äúcolname‚Äù]].</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># this will not work
</span><span class="n">df</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="s">'name'</span><span class="p">:</span><span class="s">'age'</span><span class="p">]</span>
</code></pre></div></div>
<p>df.iloc is loc but with indices instead of names.
There is also <code class="highlighter-rouge">df.query</code>, so <code class="highlighter-rouge">df.query("Salary == max_salary")</code> is equivalent to <code class="highlighter-rouge">df[df['Salary'] == max_salary]</code></p>
<table>
 <tbody>
   <tr>
     <td>In the boolean mask, and and or are replaced by &amp; and
     <td>. In addition, the logical expressions connected by &amp; and
     <td>must be inside parens, e.g. (a) &amp; (b).
</table>
<p>To create a DataFrame from scratch and then modify:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">()</span> <span class="c1"># makes an empty df
</span><span class="n">df</span><span class="p">[</span><span class="s">"newcol"</span><span class="p">]</span> <span class="o">=</span> <span class="n">list_like_var</span> <span class="c1"># also df = pd.DataFrame({newcol: list_like_var})
</span><span class="n">df</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="s">"colname"</span><span class="p">)</span> <span class="c1">#removes column
</span></code></pre></div></div>
<p><code class="highlighter-rouge">df.sort_values()</code> sorts according to the index by default. Takes an optional parameter <code class="highlighter-rouge">by="colname"</code>
<code class="highlighter-rouge">df["col"].unique()</code> returns a np.array of unique elements
<code class="highlighter-rouge">df.drop_duplicates()</code> returns a df without repeated rows.</p>
<ul>
 <li>Has optional params subset = [‚Äúcol1‚Äù, ‚Äúcol2‚Äù, ‚Ä¶] to indicate the cols that determine uniqueness
 <li>Has optional params inplace=True (like many other methods)
</ul>
<p><code class="highlighter-rouge">df.itertuples()</code> iterates over rows as tuples, e.g.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="n">employees</span><span class="p">[</span><span class="s">'bonus'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="p">.</span><span class="n">salary</span> <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">.</span><span class="n">employee_id</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">lucky</span><span class="p">(</span><span class="n">row</span><span class="p">.</span><span class="n">name</span><span class="p">))</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">employees</span><span class="p">.</span><span class="n">itertuples</span><span class="p">()]</span>
</code></pre></div></div>
<p><code class="highlighter-rouge">df["col"].apply(f)</code> applies <code class="highlighter-rouge">f</code> to each element of <code class="highlighter-rouge">df["col"]</code></p>
<p><code class="highlighter-rouge">pd.merge(df1, df2, on="col")</code> merges on the column.</p>
<ul>
 <li>If the column names are different then there is left_on= and right_on=.
 <li>
   <p>By default, how=‚Äùinner‚Äù which means that rows that do not have a common value on ‚Äúcol‚Äù are dropped. There is also:</p>
   <ul>
     <li>how=‚Äùouter‚Äù: any extra rows are added with missing entries turned into NaN
     <li>how=‚Äùleft‚Äù: left outer, i.e. only extra rows from the left are added
     <li>how=‚Äùright‚Äù similarly
     <li>how=‚Äùcross‚Äù: creates a kronecker product of the two dfs.
   </ul>
 <li>df.rank() gives a float ranking based on the position after sorting. Optional param ascending=False: same as sorted(lst, reversed=True). There is a more complicated optional param called method:
</ul>
<p>Suppose we have a dataframe called df with a column called ‚Äòscore‚Äô that has the following values:
[10, 20, 20, 30, 40, 40, 40].
If we use df[‚Äòscore‚Äô].rank(method=‚Äôaverage‚Äô), the rank values will be:
[1.0, 2.5, 2.5, 4.0, 6.0, 6.0, 6.0].
This is because the average of the positions of the equal values is used as the rank. For example, the two values of 20 are in positions 2 and 3, so their rank is (2 + 3) / 2 = 2.5.
If we use df[‚Äòscore‚Äô].rank(method=‚Äômin‚Äô), the rank values will be:
[1.0, 2.0, 2.0, 4.0, 5.0, 5.0, 5.0].
This is because the minimum of the positions of the equal values is used as the rank. For example, the two values of 20 are in positions 2 and 3, so their rank is min(2, 3) = 2.
If we use df[‚Äòscore‚Äô].rank(method=‚Äômax‚Äô), the rank values will be:
[1.0, 3.0, 3.0, 4.0, 7.0, 7.0, 7.0].
This is because the maximum of the positions of the equal values is used as the rank. For example, the two values of 20 are in positions 2 and 3, so their rank is max(2, 3) = 3.
If we use df[‚Äòscore‚Äô].rank(method=‚Äôfirst‚Äô), the rank values will be:
[1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0].
This is because the order of appearance of the equal values is used as the rank. For example, the two values of 20 are in positions 2 and 3, but the first one has a lower rank than the second one.
If we use df[‚Äòscore‚Äô].rank(method=‚Äôdense‚Äô), the rank values will be:
[1.0, 2.0, 2.0, 3.0, 4.0, 4.0, 4.0].
This is because the rank always increases by one between groups of equal values. For example, the two values of 20 have the same rank of 2, and the next value of 30 has a rank of 3.</p>
<ul>
 <li>
   <p>df.groupby(‚Äúcol‚Äù) makes an intermediate object that is useful for further processing.</p>
 <li>
   <p>df.melt and df.pivot are sort of inverses to each other.
The <code class="highlighter-rouge">melt</code> method takes four arguments: <code class="highlighter-rouge">id_vars</code>, <code class="highlighter-rouge">value_vars</code>, <code class="highlighter-rouge">var_name</code>, and <code class="highlighter-rouge">value_name</code>. These arguments specify which columns of the pivoted dataframe to use as the identifier variables, value variables, variable name, and value name of the melted dataframe, respectively. For example, if you have a pivoted dataframe like this:</p>
</ul>
<table>
<thead>
   <tr>
     <th>type
     <th>a
     <th>b
     <th>c
 <tbody>
   <tr>
     <td>label
     <td>¬†
     <td>¬†
     <td>¬†
   <tr>
     <td>x
     <td>1
     <td>2
     <td>3
   <tr>
     <td>y
     <td>4
     <td>5
     <td>6
   <tr>
     <td>z
     <td>7
     <td>8
     <td>9
</table>
<p>You can <code class="highlighter-rouge">melt</code> like this:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">melted_df</span> <span class="o">=</span> <span class="n">pivoted_df</span><span class="p">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="s">'label'</span><span class="p">,</span> <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s">'a'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">,</span> <span class="s">'c'</span><span class="p">],</span> <span class="n">var_name</span><span class="o">=</span><span class="s">'type'</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s">'value'</span><span class="p">)</span>
</code></pre></div></div>
<p>The result will be a melted dataframe like this:</p>
<table>
<thead>
   <tr>
     <th>label
     <th>type
     <th>value
 <tbody>
   <tr>
     <td>x
     <td>a
     <td>1
   <tr>
     <td>x
     <td>b
     <td>2
   <tr>
     <td>x
     <td>c
     <td>3
   <tr>
     <td>y
     <td>a
     <td>4
   <tr>
     <td>y
     <td>b
     <td>5
   <tr>
     <td>y
     <td>c
     <td>6
   <tr>
     <td>z
     <td>a
     <td>7
   <tr>
     <td>z
     <td>b
     <td>8
   <tr>
     <td>z
     <td>c
     <td>9
</table>
<p>and you can go back using</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pivoted_df</span> <span class="o">=</span> <span class="n">melted_df</span><span class="p">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s">'label'</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s">'type'</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s">'value'</span><span class="p">)</span>
</code></pre></div></div>
<p><code class="highlighter-rouge">df.reset_index()</code> turns the index back to the default (undos tuple indexing)</p>
</div>
<span class="toggle"></span>
<span class="wave"></span>
<br>
<div id="disqus_thread"></div>
<script>
var disqus_config = function () {
this.page.url = 'http://localhost:4000/2023/08/26/30-Days-Of-Pandas.html';
this.page.identifier = '/2023/08/26/30-Days-Of-Pandas.html'; 
this.page.title = '30 Days of Pandas';
};
(function() {
var d = document, s = d.createElement('script');
s.src = 'https://clvnkhr.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<br>
<div class="about">
<div class="about__devider">‚úÆ‚úÆ‚úÆ</div>
<div class="about__text">
<br>
&#169 2023-2024 Calvin Khor | Made using the <a href="https://github.com/ritijjain/pudhina-fresh">Pudhina Fresh</a> theme for Jekyll.
</div>
</div>
</div>

<script>
const options = {
    bottom: '32px', // default: '32px'
    right: '32px', // default: '32px'
    left: 'unset', // default: 'unset'
    time: '0.3s', // default: '0.3s'
    mixColor: 'rgba( 230, 230, 230, 100%)', // default: '#fff'
    backgroundColor: '#fff',  // default: '#fff'
    buttonColorDark: '#100f2c',  // default: '#100f2c'
    buttonColorLight: '#fff', // default: '#fff'
    saveInCookies: true, // default: true,
    label: 'üåì', // default: ''
    autoMatchOsTheme: true // default: true
    }
const darkmode = new Darkmode(options);
render_dark_mode_icon(darkmode, 'dark_mode_toggle');
</script>
